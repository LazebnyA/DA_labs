Імпортувати модулі для побудови графіків
```{r}
library(tidyverse)
library(ggridges)
library(egg)
```
Імпортувати дані
```{r}
binary_variables <- c(
  "Diabetes",
  "HighBP", 
  "HighChol", 
  "CholCheck", 
  "Smoker", 
  "Stroke", 
  "HeartDiseaseorAttack", 
  "PhysActivity", 
  "Fruits", 
  "Veggies",
  "HvyAlcoholConsump",
  "AnyHealthcare",
  "NoDocbcCost",
  "DiffWalk"
)

category_variables <- c("Age", "Education", "Income")

gen.hlth_categories <- c("excellent", "very good",
                         "good", "fair", "poor")

sex_categories <- c("female", "male")

age_categories <- c("18-24", "25-29", "30-34", "35-39",
                    "40-44", "45-49", "50-54", "55-59",
                    "60-64", "65-69", "70-74", "75-79",
                    "80+")

edc_categories <- c("No education", 
                    "Elementary", 
                    "Some high school", 
                    "High school graduate", 
                    "Some college or tech. school", 
                    "College graduate")

income_categories <- c("Less than $10,000",
                       "$10,000-$15,000",
                       "$15,000-$20,000",
                       "$20,000-$25,000",
                       "$25,000-$35,000",
                       "$35,000-$50,000",
                       "$50,000-$75,000",
                       "$75,000 or more")


data <- read_csv("prepared_data.csv") %>%
  mutate(Sex = factor(Sex)) %>%
  mutate(GenHlth = factor(GenHlth, ordered = TRUE, levels = rev(gen.hlth_categories))) %>%
  mutate(Sex = factor(Sex)) %>%
  mutate(Age = factor(Age, ordered = TRUE, levels = age_categories)) %>%
  mutate(Education = factor(Education, ordered = TRUE, levels = edc_categories)) %>%
  mutate(Income = factor(Income, ordered = TRUE, levels = income_categories)) %>%
  mutate(across(all_of(binary_variables), as.logical))
```
Створення словника для приведення категорійної змінної Income у числовий тип та список підписів
```{r}
nums <- c(
  "Less than $10,000"=1,
  "$10,000-$15,000"=2,
  "$15,000-$20,000"=3,
  "$20,000-$25,000"=4,
  "$25,000-$35,000"=5,
  "$35,000-$50,000"=6,
  "$50,000-$75,000"=7,
  "$75,000 or more"=8
)
labs <- c("Less than $10,000", "$10,000-$15,000", "$15,000-$20,000", "$20,000-$25,000", "$25,000-$35,000", "$35,000-$50,000", "$50,000-$75,000", "$75,000 or more")
```
Залежність розподілу доходів від рівня освіти (мед. обстеження)
```{r}
p <- ggplot(data,aes(x=nums[Income], y=Education, fill = AnyHealthcare),rotate = 90) +
  geom_density_ridges(stat="binline", bins=8, alpha = 0.5, position = "dodge") +
  labs(x="Дохід", y="Рівень освіти", subtitle="Залежність розподілу доходів від рівня освіти (мед. обстеження)", caption="(a) - немає діабету, (b) - діабет") +
  theme(axis.title = element_text(size=14),
        axis.text.x = element_text(size=10, angle = 90),
        axis.text.y = element_text(size=10),
        plot.subtitle = element_text(size = 14)) +
  facet_wrap(.~Diabetes)
(tag_facet(p + scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8),
                     labels=labs)))
```
Залежність розподілу доходів від рівня освіти (фрукти)
```{r}
p <- ggplot(data,aes(x=nums[Income], y=Education, fill = Fruits),rotate = 90) +
  geom_density_ridges(stat="binline", bins=8, alpha = 0.5, position = "dodge") +
  labs(x="Дохід", y="Рівень освіти", subtitle="Залежність розподілу доходів від рівня освіти (фрукти)", caption="(a) - немає діабету, (b) - діабет") +
  theme(axis.title = element_text(size=14),
        axis.text.x = element_text(size=10, angle = 90),
        axis.text.y = element_text(size=10),
        plot.subtitle = element_text(size = 14)) +
  facet_wrap(.~Diabetes)
(tag_facet(p + scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8),
                                  labels=labs)))
```
Залежність розподілу доходів від рівня освіти (алкоголь)
```{r}
p <- ggplot(data,aes(x=nums[Income], y=Education, fill = HvyAlcoholConsump),rotate = 90) +
  geom_density_ridges(stat="binline", bins=8, alpha = 0.5, position = "dodge") +
  labs(x="Дохід", y="Рівень освіти", subtitle="Залежність розподілу доходів від рівня освіти (алкоголь)", caption="(a) - немає діабету, (b) - діабет") +
  theme(axis.title = element_text(size=14),
        axis.text.x = element_text(size=10, angle = 90),
        axis.text.y = element_text(size=10),
        plot.subtitle = element_text(size = 14)) +
  facet_wrap(.~Diabetes)
(tag_facet(p + scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8),
                                  labels=labs)))
```
Залежність розподілу доходів від рівня освіти (паління)
```{r}
p <- ggplot(data,aes(x=nums[Income], y=Education, fill = Smoker),rotate = 90) +
  geom_density_ridges(stat="binline", bins=8, alpha = 0.5, position = "dodge") +
  labs(x="Дохід", y="Рівень освіти", subtitle="Залежність розподілу доходів від рівня освіти (паління)", caption="(a) - немає діабету, (b) - діабет") +
  theme(axis.title = element_text(size=14),
        axis.text.x = element_text(size=10, angle = 90),
        axis.text.y = element_text(size=10),
        plot.subtitle = element_text(size = 14)) +
  facet_wrap(.~Diabetes)
(tag_facet(p + scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8),
                     labels=labs)))
```
Залежність розподілу доходів від рівня освіти (овочі)
```{r}
p <- ggplot(data,aes(x=nums[Income], y=Education, fill = Veggies),rotate = 90) +
  geom_density_ridges(stat="binline", bins=8, alpha = 0.5, position = "dodge") +
  labs(x="Дохід", y="Рівень освіти", subtitle="Залежність розподілу доходів від рівня освіти (овочі)", caption="(a) - немає діабету, (b) - діабет") +
  theme(axis.title = element_text(size=14),
        axis.text.x = element_text(size=10, angle = 90),
        axis.text.y = element_text(size=10),
        plot.subtitle = element_text(size = 14)) +
  facet_wrap(.~Diabetes)
(tag_facet(p + scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8),
                                  labels=labs)))
```